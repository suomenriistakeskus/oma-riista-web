<?xml version="1.0" encoding="UTF-8" standalone="yes"?>

<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.8.xsd"
        logicalFilePath="migrations/db.changelog.xml">

    <changeSet id="2019-01-03-decision-delivery-address-for-application" author="vincit-terole">
        <addColumn tableName="harvest_permit_application">
            <column name="delivery_address_recipient" type="VARCHAR(255)"/>
            <column name="delivery_address_street_address" type="VARCHAR(255)"/>
            <column name="delivery_address_postal_code" type="VARCHAR(255)"/>
            <column name="delivery_address_city" type="VARCHAR(255)"/>
        </addColumn>

        <sql dbms="postgresql"><![CDATA[
            ALTER TABLE harvest_permit_application
            ADD CONSTRAINT ck_harvest_permit_application_delivery_address_all_or_none_null
            CHECK ((delivery_address_recipient IS NULL
                    AND delivery_address_street_address IS NULL
                    AND delivery_address_postal_code IS NULL
                    AND delivery_address_city IS NULL)
                OR (delivery_address_recipient IS NOT NULL
                    AND delivery_address_street_address IS NOT NULL
                    AND delivery_address_postal_code IS NOT NULL
                    AND delivery_address_city IS NOT NULL));
        ]]></sql>
    </changeSet>

    <changeSet id="2019-01-03-decision-delivery-address-for-decision" author="vincit-terole">
        <addColumn tableName="permit_decision">
            <column name="delivery_address_recipient" type="VARCHAR(255)"/>
            <column name="delivery_address_street_address" type="VARCHAR(255)"/>
            <column name="delivery_address_postal_code" type="VARCHAR(255)"/>
            <column name="delivery_address_city" type="VARCHAR(255)"/>
        </addColumn>

        <sql dbms="postgresql"><![CDATA[
            ALTER TABLE permit_decision
            ADD CONSTRAINT ck_permit_decision_delivery_address_all_or_none_null
            CHECK ((delivery_address_recipient IS NULL
                    AND delivery_address_street_address IS NULL
                    AND delivery_address_postal_code IS NULL
                    AND delivery_address_city IS NULL)
                OR (delivery_address_recipient IS NOT NULL
                    AND delivery_address_street_address IS NOT NULL
                    AND delivery_address_postal_code IS NOT NULL
                    AND delivery_address_city IS NOT NULL));
        ]]></sql>
    </changeSet>

    <changeSet id="2019-01-08-mandatory-delivery-address-for-decision" author="vincit-terole">
        <sql dbms="postgresql"><![CDATA[
            UPDATE permit_decision
            SET delivery_address_recipient = sub.fn || ' ' || sub.ln,
                delivery_address_street_address = COALESCE(sub.street, '-'),
                delivery_address_postal_code = COALESCE(sub.code, '-'),
                delivery_address_city = COALESCE(sub.city, '-')
            FROM (
                SELECT permit_decision_id AS id,
                       person.first_name AS fn,
                       person.last_name AS ln,
                       address.street_address AS street,
                       address.postal_code AS code,
                       address.city AS city
                FROM permit_decision d2
                INNER JOIN person ON person.person_id = d2.contact_person_id
                LEFT JOIN address ON COALESCE(person.mr_address_id, person.other_address_id) = address_id
                ) AS sub
            WHERE delivery_address_recipient IS NULL
            AND sub.id = permit_decision_id;
        ]]></sql>

        <sql dbms="postgresql"><![CDATA[
            ALTER TABLE permit_decision
            DROP CONSTRAINT ck_permit_decision_delivery_address_all_or_none_null
        ]]></sql>

        <addNotNullConstraint tableName="permit_decision" columnName="delivery_address_recipient"
                              columnDataType="VARCHAR(255)"/>
        <addNotNullConstraint tableName="permit_decision" columnName="delivery_address_street_address"
                              columnDataType="VARCHAR(255)"/>
        <addNotNullConstraint tableName="permit_decision" columnName="delivery_address_postal_code"
                              columnDataType="VARCHAR(255)"/>
        <addNotNullConstraint tableName="permit_decision" columnName="delivery_address_city"
                              columnDataType="VARCHAR(255)"/>

        <sql dbms="postgresql"><![CDATA[
            UPDATE harvest_permit_application
            SET delivery_address_recipient = sub.fn || ' ' || sub.ln,
                delivery_address_street_address = COALESCE(sub.street, '-'),
                delivery_address_postal_code = COALESCE(sub.code, '-'),
                delivery_address_city = COALESCE(sub.city, '-')
            FROM (
                SELECT harvest_permit_application_id AS id,
                       person.first_name AS fn,
                       person.last_name AS ln,
                       address.street_address AS street,
                       address.postal_code AS code,
                       address.city AS city
                FROM harvest_permit_application hpa
                INNER JOIN person ON person.person_id = hpa.contact_person_id
                LEFT JOIN address ON COALESCE(person.mr_address_id, person.other_address_id) = address_id
                ) AS sub
            WHERE delivery_address_recipient IS NULL
            AND sub.id = harvest_permit_application_id;
        ]]></sql>

        <sql dbms="postgresql"><![CDATA[
            ALTER TABLE harvest_permit_application
            ADD CONSTRAINT ck_harvest_permit_application_delivery_address_not_null_after_send
            CHECK ((status = 'DRAFT')
                OR (delivery_address_recipient IS NOT NULL
                    AND delivery_address_street_address IS NOT NULL
                    AND delivery_address_postal_code IS NOT NULL
                    AND delivery_address_city IS NOT NULL));
        ]]></sql>
    </changeSet>

    <changeSet id="2019-01-10-application-unique-constraints" author="vincit-kyostihe">
        <addUniqueConstraint tableName="harvest_permit_application" columnNames="application_number"
                             constraintName="uk_harvest_permit_application_application_number"/>
        <addUniqueConstraint tableName="harvest_permit_application" columnNames="uuid"
                             constraintName="uk_harvest_permit_application_uuid"/>
    </changeSet>

    <changeSet id="2019-01-10-move-permit-number-and-type-to-decision" author="vincit-kyostihe">
        <addColumn tableName="permit_decision">
            <column name="decision_year" type="INT" afterColumn="status"/>
            <column name="validity_years" type="INT" afterColumn="status"/>
            <column name="decision_number" type="INT" afterColumn="status"/>
            <column name="permit_type_code" type="VARCHAR(3)" afterColumn="status"/>
        </addColumn>

        <sql dbms="postgresql"><![CDATA[
            UPDATE permit_decision
            SET decision_number = hpa.application_number,
            decision_year = hpa.hunting_year,
            validity_years = 1,
            permit_type_code = hpa.permit_type_code
            FROM harvest_permit_application hpa
            WHERE permit_decision.application_id = hpa.harvest_permit_application_id;
        ]]></sql>

        <addNotNullConstraint tableName="permit_decision" columnName="decision_year" columnDataType="INT"/>
        <addNotNullConstraint tableName="permit_decision" columnName="validity_years" columnDataType="INT"/>
        <addNotNullConstraint tableName="permit_decision" columnName="decision_number" columnDataType="INT"/>
        <addNotNullConstraint tableName="permit_decision" columnName="permit_type_code" columnDataType="VARCHAR(3)"/>

        <addUniqueConstraint tableName="permit_decision" columnNames="decision_number"
                             constraintName="uk_permit_decision_decision_number"/>

        <sql><![CDATA[
            ALTER TABLE harvest_permit_application DROP CONSTRAINT harvest_permit_application_permit_number_check;
        ]]></sql>

        <dropUniqueConstraint tableName="harvest_permit_application"
                              constraintName="uk_harvest_permit_application_permit_number"/>
        <dropColumn tableName="harvest_permit_application" columnName="permit_number"/>
        <dropColumn tableName="harvest_permit_application" columnName="permit_type_code"/>
    </changeSet>

    <changeSet id="2019-01-08-permit-decision-forbidden-methods" author="vincit-kyostihe">
        <createTable tableName="forbidden_method_type">
            <column name="name" type="VARCHAR(255)">
                <constraints primaryKey="true"/>
            </column>
        </createTable>

        <insert tableName="forbidden_method_type">
            <column name="name" value="SNARES"/>
        </insert>

        <insert tableName="forbidden_method_type">
            <column name="name" value="LIVE_ANIMAL_DECOY"/>
        </insert>

        <insert tableName="forbidden_method_type">
            <column name="name" value="TAPE_RECORDERS"/>
        </insert>

        <insert tableName="forbidden_method_type">
            <column name="name" value="ELECTRICAL_DEVICE"/>
        </insert>

        <insert tableName="forbidden_method_type">
            <column name="name" value="ARTIFICIAL_LIGHT"/>
        </insert>

        <insert tableName="forbidden_method_type">
            <column name="name" value="MIRRORS"/>
        </insert>

        <insert tableName="forbidden_method_type">
            <column name="name" value="ILLUMINATION_DEVICE"/>
        </insert>

        <insert tableName="forbidden_method_type">
            <column name="name" value="NIGHT_SHOOTING_DEVICE"/>
        </insert>

        <insert tableName="forbidden_method_type">
            <column name="name" value="EXPLOSIVES"/>
        </insert>

        <insert tableName="forbidden_method_type">
            <column name="name" value="NETS"/>
        </insert>

        <insert tableName="forbidden_method_type">
            <column name="name" value="TRAPS"/>
        </insert>

        <insert tableName="forbidden_method_type">
            <column name="name" value="POISON"/>
        </insert>

        <insert tableName="forbidden_method_type">
            <column name="name" value="GASSING"/>
        </insert>

        <insert tableName="forbidden_method_type">
            <column name="name" value="AUTOMATIC_WEAPON"/>
        </insert>

        <insert tableName="forbidden_method_type">
            <column name="name" value="LIMES"/>
        </insert>

        <insert tableName="forbidden_method_type">
            <column name="name" value="HOOKS"/>
        </insert>

        <insert tableName="forbidden_method_type">
            <column name="name" value="CROSSBOWS"/>
        </insert>

        <insert tableName="forbidden_method_type">
            <column name="name" value="OTHER_SELECTIVE"/>
        </insert>

        <insert tableName="forbidden_method_type">
            <column name="name" value="OTHER_NON_SELECTIVE"/>
        </insert>

        <createTable tableName="permit_decision_forbidden_method">
            <column autoIncrement="true" name="permit_decision_forbidden_method_id" type="BIGSERIAL">
                <constraints primaryKey="true" primaryKeyName="permit_decision_forbidden_method_pkey"/>
            </column>
            <column name="consistency_version" type="INT" defaultValueNumeric="0">
                <constraints nullable="false"/>
            </column>

            <column name="created_by_user_id" type="BIGINT"/>
            <column name="deleted_by_user_id" type="BIGINT"/>
            <column name="modified_by_user_id" type="BIGINT"/>

            <column name="creation_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="modification_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="deletion_time" type="TIMESTAMP WITH TIME ZONE"/>

            <column name="permit_decision_id" type="BIGINT">
                <constraints references="permit_decision(permit_decision_id)"
                             foreignKeyName="fk_permit_decision_forbidden_method_decision_id"/>
            </column>
            <column name="game_species_id" type="BIGINT">
                <constraints nullable="false" references="game_species(game_species_id)"
                             foreignKeyName="fk_permit_decision_forbidden_method_game_species_id"/>
            </column>
            <column name="method" type="VARCHAR(255)">
                <constraints nullable="false"
                             references="forbidden_method_type(name)"
                             foreignKeyName="fk_permit_decision_forbidden_method_type"/>
            </column>
        </createTable>

        <createIndex tableName="permit_decision_forbidden_method"
                     indexName="uk_permit_decision_forbidden_method_decision"
                     unique="true">
            <column name="permit_decision_id"/>
            <column name="game_species_id"/>
            <column name="method"/>
        </createIndex>
    </changeSet>

    <changeSet id="2019-01-09-permit-decision-extra" author="vincit-kyostihe">
        <addColumn tableName="permit_decision">
            <column name="decision_extra" type="TEXT" afterColumn="decision_body"/>
        </addColumn>

        <addColumn tableName="permit_decision_revision">
            <column name="decision_extra" type="TEXT" afterColumn="decision_body"/>
        </addColumn>
    </changeSet>

    <changeSet id="2019-01-10-add-luke_carnivore_contact_persons-into-rhy_annual_statistics" author="vincit-jarkkoka">
        <addColumn tableName="rhy_annual_statistics">
            <column name="luke_carnivore_contact_persons" type="INT"/>
        </addColumn>

        <sql><![CDATA[
            ALTER TABLE rhy_annual_statistics ADD CONSTRAINT ck_rhy_annual_statistics_luke_carnivore_contact_persons
                CHECK (luke_carnivore_contact_persons >= 0);
        ]]></sql>
    </changeSet>

    <changeSet id="2019-01-08-add-basic_info_last_modified-column-into-rhy-annual-statistics" author="vincit-jarkkoka">
        <addColumn tableName="rhy_annual_statistics">
            <column name="basic_info_last_modified" type="TIMESTAMP WITH TIME ZONE"/>
        </addColumn>
    </changeSet>

    <changeSet id="2019-01-17-add-cause-fields-for-permit-decision" author="vincit-terole">
        <createTable tableName="permit_decision_derogation_reason_type">
            <column name="name" type="VARCHAR(255)">
                <constraints primaryKey="true"/>
            </column>
        </createTable>

        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_PUBLIC_HEALTH"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_PUBLIC_SAFETY"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_AVIATION_SAFETY"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_CROPS_DAMAMGE"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_DOMESTIC_PETS"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_FOREST_DAMAGE"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_FISHING"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_WATER_SYSTEM"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_FLORA"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_FAUNA"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_RESEARCH"/>
        </insert>

        <createTable tableName="permit_decision_derogation_reason">
            <column autoIncrement="true" name="permit_decision_derogation_reason_id" type="BIGSERIAL">
                <constraints primaryKey="true" primaryKeyName="permit_decision_derogation_reason_pkey"/>
            </column>
            <column name="consistency_version" type="INT" defaultValueNumeric="0">
                <constraints nullable="false"/>
            </column>

            <column name="created_by_user_id" type="BIGINT"/>
            <column name="deleted_by_user_id" type="BIGINT"/>
            <column name="modified_by_user_id" type="BIGINT"/>

            <column name="creation_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="modification_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="deletion_time" type="TIMESTAMP WITH TIME ZONE"/>

            <column name="permit_decision_id" type="BIGINT">
                <constraints nullable="false"
                             references="permit_decision(permit_decision_id)"
                             foreignKeyName="fk_permit_decision_derogation_reason_decision_id"/>
            </column>
            <column name="reason_type" type="VARCHAR(255)">
                <constraints nullable="false"
                             references="permit_decision_derogation_reason_type(name)"
                             foreignKeyName="fk_permit_decision_derogation_reason_type"/>
            </column>
        </createTable>

        <createIndex tableName="permit_decision_derogation_reason"
                     indexName="uk_permit_decision_derogation_reason"
                     unique="true">
            <column name="permit_decision_id"/>
            <column name="reason_type"/>
        </createIndex>
    </changeSet>

    <changeSet id="2019-01-11-add-rhy_annual_statistics_editable_data_group-table" author="vincit-jarkkoka">
        <createTable tableName="rhy_annual_statistics_editable_data_group">
            <column name="name" type="VARCHAR(255)">
                <constraints primaryKey="true"/>
            </column>
        </createTable>

        <insert tableName="rhy_annual_statistics_editable_data_group">
            <column name="name" value="BASIC_INFO"/>
        </insert>
        <insert tableName="rhy_annual_statistics_editable_data_group">
            <column name="name" value="HUNTER_EXAMS"/>
        </insert>
        <insert tableName="rhy_annual_statistics_editable_data_group">
            <column name="name" value="SHOOTING_TESTS"/>
        </insert>
        <insert tableName="rhy_annual_statistics_editable_data_group">
            <column name="name" value="GAME_DAMAGE"/>
        </insert>
        <insert tableName="rhy_annual_statistics_editable_data_group">
            <column name="name" value="HUNTING_CONTROL"/>
        </insert>
        <insert tableName="rhy_annual_statistics_editable_data_group">
            <column name="name" value="OTHER_PUBLIC_ADMIN_TASKS"/>
        </insert>
        <insert tableName="rhy_annual_statistics_editable_data_group">
            <column name="name" value="HUNTER_EXAM_TRAINING"/>
        </insert>
        <insert tableName="rhy_annual_statistics_editable_data_group">
            <column name="name" value="JHT_TRAINING"/>
        </insert>
        <insert tableName="rhy_annual_statistics_editable_data_group">
            <column name="name" value="HUNTER_TRAINING"/>
        </insert>
        <insert tableName="rhy_annual_statistics_editable_data_group">
            <column name="name" value="OTHER_HUNTER_TRAINING"/>
        </insert>
        <insert tableName="rhy_annual_statistics_editable_data_group">
            <column name="name" value="PUBLIC_EVENTS"/>
        </insert>
        <insert tableName="rhy_annual_statistics_editable_data_group">
            <column name="name" value="OTHER_HUNTING_RELATED"/>
        </insert>
        <insert tableName="rhy_annual_statistics_editable_data_group">
            <column name="name" value="COMMUNICATION"/>
        </insert>
        <insert tableName="rhy_annual_statistics_editable_data_group">
            <column name="name" value="SHOOTING_RANGES"/>
        </insert>
        <insert tableName="rhy_annual_statistics_editable_data_group">
            <column name="name" value="LUKE"/>
        </insert>
        <insert tableName="rhy_annual_statistics_editable_data_group">
            <column name="name" value="METSAHALLITUS"/>
        </insert>
    </changeSet>

    <changeSet id="2019-01-11-add-rhy_annual_statistics_moderator_update_event-table" author="vincit-jarkkoka">
        <createTable tableName="rhy_annual_statistics_moderator_update_event">
            <column autoIncrement="true" name="rhy_annual_statistics_moderator_update_event_id" type="BIGSERIAL">
                <constraints primaryKey="true" primaryKeyName="rhy_annual_statistics_moderator_update_event_pkey"/>
            </column>
            <column name="consistency_version" type="INT" defaultValueNumeric="0">
                <constraints nullable="false"/>
            </column>

            <column name="statistics_id" type="BIGINT">
                <constraints nullable="false"
                             references="rhy_annual_statistics(rhy_annual_statistics_id)"
                             foreignKeyName="fk_rhy_annual_statistics_moderator_update_event_statistics"/>
            </column>
            <column name="data_group" type="VARCHAR(255)">
                <constraints nullable="false"
                             references="rhy_annual_statistics_editable_data_group(name)"
                             foreignKeyName="fk_rhy_annual_statistics_moderator_update_event_data_group"/>
            </column>
            <column name="event_time" type="TIMESTAMP WITH TIME ZONE">
                <constraints nullable="false"/>
            </column>
            <column name="user_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <createIndex tableName="rhy_annual_statistics_moderator_update_event"
                     indexName="ndx_rhy_annual_statistics_moderator_update_event_statistics">
            <column name="statistics_id"/>
        </createIndex>
    </changeSet>

    <changeSet id="2019-01-23-permit-decision-protected-area-type" author="vincit-terole">

        <createTable tableName="permit_decision_protected_area_type">
            <column autoIncrement="true" name="permit_decision_protected_area_type_id" type="BIGSERIAL">
                <constraints primaryKey="true" primaryKeyName="permit_decision_protected_area_type_pkey"/>
            </column>
            <column name="consistency_version" type="INT" defaultValueNumeric="0">
                <constraints nullable="false"/>
            </column>

            <column name="created_by_user_id" type="BIGINT"/>
            <column name="deleted_by_user_id" type="BIGINT"/>
            <column name="modified_by_user_id" type="BIGINT"/>

            <column name="creation_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="modification_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="deletion_time" type="TIMESTAMP WITH TIME ZONE"/>

            <column name="permit_decision_id" type="BIGINT">
                <constraints nullable="false"
                             references="permit_decision(permit_decision_id)"
                             foreignKeyName="fk_permit_decision_protected_area_type_decision_id"/>
            </column>
            <column name="protected_area_type" type="VARCHAR(255)">
                <constraints nullable="false"
                             references="bird_permit_application_protected_area_type(name)"
                             foreignKeyName="fk_permit_decision_protected_area_type"/>
            </column>
        </createTable>

        <createIndex tableName="permit_decision_protected_area_type"
                     indexName="uk_permit_decision_protected_area_type"
                     unique="true">
            <column name="permit_decision_id"/>
            <column name="protected_area_type"/>
        </createIndex>
    </changeSet>

    <changeSet id="2019-01-28-rename-timestamp-field-in-rhy_annual_statistics_state_change_event"
               author="vincit-jarkkoka">
        <renameColumn tableName="rhy_annual_statistics_state_change_event"
                      oldColumnName="point_of_time"
                      newColumnName="event_time"/>
    </changeSet>

    <changeSet id="2019-01-28-permit-decision-add-legal-fields" author="vincit-kyostihe">
        <addColumn tableName="permit_decision">
            <column name="legal_section_32" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
            <column name="legal_section_33" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
            <column name="legal_section_34" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
            <column name="legal_section_35" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
            <column name="legal_section_51" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
        </addColumn>
    </changeSet>

    <changeSet id="2019-01-28-more-forbidden-methods" author="vincit-kyostihe">
        <insert tableName="forbidden_method_type">
            <column name="name" value="SPEAR"/>
        </insert>

        <insert tableName="forbidden_method_type">
            <column name="name" value="BLOWPIPE"/>
        </insert>

        <insert tableName="forbidden_method_type">
            <column name="name" value="LEGHOLD_TRAP"/>
        </insert>

        <insert tableName="forbidden_method_type">
            <column name="name" value="CONCEALED_WEAPON"/>
        </insert>
    </changeSet>

    <changeSet id="2019-01-28-permit-decision-species-complete-status" author="vincit-kyostihe">
        <addColumn tableName="permit_decision_species_amount">
            <column name="amount_complete" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>

            <column name="forbidden_method_complete" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
        </addColumn>
    </changeSet>

    <changeSet id="2019-02-04-permit-decision-revision-creator-index" author="vincit-kyostihe">
        <createIndex tableName="permit_decision_revision" indexName="ndx_permit_decision_revision_created_by_user_id">
            <column name="created_by_user_id"/>
        </createIndex>
    </changeSet>

    <changeSet id="2019-02-12-permit-decision-validity-years-constraints" author="vincit-terole">
        <sql dbms="postgresql"><![CDATA[
            ALTER TABLE permit_decision ADD CONSTRAINT ck_permit_decision_validity_years
              CHECK (validity_years > 0 AND validity_years <= 5);
        ]]></sql>

    </changeSet>

    <changeSet id="2019-02-12-harvest-permit-add-column-permit-year" author="vincit-terole">
        <addColumn tableName="harvest_permit">
            <column name="permit_year" type="INTEGER"/>
        </addColumn>

        <sql dbms="postgresql"><![CDATA[
            UPDATE harvest_permit
            SET permit_year = SUBSTRING(permit_number, 0, 5)::INT;
        ]]></sql>

        <addNotNullConstraint tableName="harvest_permit" columnName="permit_year" columnDataType="INTEGER"/>

        <sql><![CDATA[
            ALTER TABLE harvest_permit ADD CONSTRAINT ck_harvest_permit_permit_year_matches_permit_number
              CHECK (permit_year = CAST(LEFT(permit_number, 4) AS INT));
        ]]></sql>

    </changeSet>

    <changeSet id="2019-02-14-personal-area" author="vincit-kyostihe">
        <createTable tableName="personal_area">
            <column autoIncrement="true" name="personal_area_id" type="BIGSERIAL">
                <constraints primaryKey="true" primaryKeyName="personal_area_pkey"/>
            </column>
            <column name="consistency_version" type="INT" defaultValueNumeric="0">
                <constraints nullable="false"/>
            </column>

            <column name="created_by_user_id" type="BIGINT"/>
            <column name="deleted_by_user_id" type="BIGINT"/>
            <column name="modified_by_user_id" type="BIGINT"/>

            <column name="creation_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="modification_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="deletion_time" type="TIMESTAMP WITH TIME ZONE"/>

            <column name="name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>

            <column name="external_id" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>

            <column name="person_id" type="BIGINT">
                <constraints nullable="false"
                             references="person(person_id)"
                             foreignKeyName="fk_personal_area_person_id"/>
            </column>

            <column name="zone_id" type="BIGINT">
                <constraints nullable="false"
                             unique="true"
                             references="zone(zone_id)"
                             foreignKeyName="fk_personal_area_zone_id"/>
            </column>
        </createTable>

        <createIndex tableName="personal_area" indexName="ndx_personal_area_person_id">
            <column name="person_id"/>
        </createIndex>

        <createIndex tableName="personal_area" indexName="ndx_personal_area_external_id" unique="true">
            <column name="external_id"/>
        </createIndex>
    </changeSet>

    <changeSet id="2019-03-01-drop-unused-metsatajarekisteri-fields" author="vincit-kyostihe">
        <dropColumn tableName="person">
            <column name="deny_post"/>
            <column name="deny_transmit"/>
        </dropColumn>
    </changeSet>

    <changeSet id="2019-02-27-add-rhy_subsidy" author="vincit-jarkkoka">
        <createTable tableName="rhy_subsidy">
            <column autoIncrement="true" name="rhy_subsidy_id" type="BIGSERIAL">
                <constraints primaryKey="true" primaryKeyName="rhy_subsidy_pkey"/>

            </column>
            <column name="consistency_version" type="INT" defaultValueNumeric="0">
                <constraints nullable="false"/>
            </column>


            <column name="created_by_user_id" type="BIGINT"/>
            <column name="deleted_by_user_id" type="BIGINT"/>
            <column name="modified_by_user_id" type="BIGINT"/>

            <column name="creation_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="modification_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="deletion_time" type="TIMESTAMP WITH TIME ZONE"/>


            <column name="rhy_id" type="BIGINT">
                <constraints nullable="false"
                             references="organisation(organisation_id)"
                             foreignKeyName="fk_rhy_subsidy_rhy"/>
            </column>

            <column name="year" type="INT">
                <constraints nullable="false"/>
            </column>

            <column name="amount_of_batch1" type="NUMERIC(9,2)">
                <constraints nullable="false"/>
            </column>

            <column name="amount_of_batch2" type="NUMERIC(9,2)"/>
        </createTable>

        <createIndex tableName="rhy_subsidy" indexName="uk_rhy_subsidy_rhy_year" unique="true">
            <column name="rhy_id"/>
            <column name="year"/>
        </createIndex>

        <sql dbms="postgresql"><![CDATA[
            ALTER TABLE rhy_subsidy ADD CONSTRAINT ck_rhy_subsidy_amount1 CHECK (amount_of_batch1 >= 0);
            ALTER TABLE rhy_subsidy ADD CONSTRAINT ck_rhy_subsidy_amount2 CHECK (amount_of_batch2 >= 0);
        ]]></sql>
    </changeSet>

    <changeSet id="2019-03-12-add-announcement-rhy-membership" author="vincit-kyostihe">
        <addColumn tableName="announcement">
            <column name="rhy_membership_subscriber_id" type="BIGINT">
                <constraints references="organisation(organisation_id)"
                             foreignKeyName="fk_announcement_membership_subscriber_id"/>
            </column>
        </addColumn>
    </changeSet>

    <changeSet id="2019-03-21-rename-hunting-year-in-application" author="vincit-terole">
        <renameColumn tableName="harvest_permit_application" oldColumnName="hunting_year"
                      newColumnName="application_year"/>
    </changeSet>

    <changeSet id="2019-03-05-harvest-permit-area-mml" author="vincit-terole">
        <createTable tableName="harvest_permit_area_mml">
            <column autoIncrement="true" name="harvest_permit_area_mml_id" type="BIGSERIAL">
                <constraints primaryKey="true" primaryKeyName="harvest_permit_area_mml_pkey"/>
            </column>
            <column name="consistency_version" type="INT" defaultValueNumeric="0">
                <constraints nullable="false"/>
            </column>
            <column name="created_by_user_id" type="BIGINT"/>
            <column name="deleted_by_user_id" type="BIGINT"/>
            <column name="modified_by_user_id" type="BIGINT"/>
            <column name="creation_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="modification_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="deletion_time" type="TIMESTAMP WITH TIME ZONE"/>

            <column name="harvest_permit_area_id" type="BIGINT">
                <constraints nullable="false"
                             references="harvest_permit_area(harvest_permit_area_id)"
                             foreignKeyName="fk_harvest_permit_area_mml_parent"/>
            </column>
            <column name="palsta_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="kiinteisto_tunnus" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="VARCHAR(255)"/>
            <column name="intersection_area" type="DOUBLE">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <createIndex tableName="harvest_permit_area_mml" indexName="nxd_harvest_permit_area_mml_tunnus_and_palsta_id"
                     unique="true">
            <column name="harvest_permit_area_id"/>
            <column name="kiinteisto_tunnus"/>
            <column name="palsta_id"/>
        </createIndex>
    </changeSet>

    <changeSet id="2019-03-08-add-country-fields-to-delivery-address" author="vincit-terole">
        <addColumn tableName="harvest_permit_application">
            <column name="delivery_address_country_name" type="VARCHAR(255)"/>
        </addColumn>

        <addColumn tableName="permit_decision">
            <column name="delivery_address_country_name" type="VARCHAR(255)"/>
        </addColumn>
    </changeSet>

    <changeSet id="2019-03-28-gis-verotus-lohko" author="vincit-kyostihe" dbms="postgresql">
        <createTable tableName="verotus_lohko">
            <column autoIncrement="true" name="gid" type="SERIAL">
                <constraints primaryKey="true" primaryKeyName="verotus_lohko_pkey"/>
            </column>
            <column name="official_code" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <sql><![CDATA[
        SELECT AddGeometryColumn('public', 'verotus_lohko', 'geom', 3067, 'MULTIPOLYGON', 2);
        CREATE INDEX ndx_verotus_lohko_geom ON verotus_lohko USING gist (geom);
        ]]></sql>

        <addNotNullConstraint tableName="verotus_lohko" columnName="geom"/>
    </changeSet>

    <changeSet id="2019-03-28-gis-verotus-lohko" author="vincit-kyostihe" dbms="h2">
        <createTable tableName="verotus_lohko">
            <column autoIncrement="true" name="gid" type="SERIAL">
                <constraints primaryKey="true" primaryKeyName="verotus_lohko_pkey"/>
            </column>
            <column name="official_code" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="geom" type="GEOMETRY">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="2019-03-28-permit-area-verotus-lohko" author="vincit-kyostihe">
        <createTable tableName="harvest_permit_area_verotus_lohko">
            <column autoIncrement="true" name="harvest_permit_area_verotus_lohko_id" type="BIGSERIAL">
                <constraints primaryKey="true" primaryKeyName="harvest_permit_area_verotus_lohko_pkey"/>
            </column>
            <column name="consistency_version" type="INT" defaultValueNumeric="0">
                <constraints nullable="false"/>
            </column>
            <column name="created_by_user_id" type="BIGINT"/>
            <column name="deleted_by_user_id" type="BIGINT"/>
            <column name="modified_by_user_id" type="BIGINT"/>
            <column name="creation_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="modification_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="deletion_time" type="TIMESTAMP WITH TIME ZONE"/>
            <column name="harvest_permit_area_id" type="BIGINT">
                <constraints nullable="false"
                             references="harvest_permit_area(harvest_permit_area_id)"
                             foreignKeyName="fk_harvest_permit_area_verotus_lohko_parent"/>
            </column>
            <column name="official_code" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="area_size" type="DOUBLE">
                <constraints nullable="false"/>
            </column>
            <column name="land_size" type="DOUBLE">
                <constraints nullable="false"/>
            </column>
            <column name="water_size" type="DOUBLE">
                <constraints nullable="false"/>
            </column>
            <column name="state_size" type="DOUBLE">
                <constraints nullable="false"/>
            </column>
            <column name="state_land_size" type="DOUBLE">
                <constraints nullable="false"/>
            </column>
            <column name="state_water_size" type="DOUBLE">
                <constraints nullable="false"/>
            </column>
            <column name="private_size" type="DOUBLE">
                <constraints nullable="false"/>
            </column>
            <column name="private_land_size" type="DOUBLE">
                <constraints nullable="false"/>
            </column>
            <column name="private_water_size" type="DOUBLE">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="2019-04-09-add-verotuslohko-area-size-fields" author="vincit-kyostihe">
        <addColumn tableName="verotus_lohko">
            <column name="area_size" type="DOUBLE" defaultValueNumeric="0">
                <constraints nullable="false"/>
            </column>
            <column name="land_size" type="DOUBLE" defaultValueNumeric="0">
                <constraints nullable="false"/>
            </column>
            <column name="water_size" type="DOUBLE" defaultValueNumeric="0">
                <constraints nullable="false"/>
            </column>
            <column name="state_size" type="DOUBLE" defaultValueNumeric="0">
                <constraints nullable="false"/>
            </column>
            <column name="state_land_size" type="DOUBLE" defaultValueNumeric="0">
                <constraints nullable="false"/>
            </column>
            <column name="state_water_size" type="DOUBLE" defaultValueNumeric="0">
                <constraints nullable="false"/>
            </column>
            <column name="private_size" type="DOUBLE" defaultValueNumeric="0">
                <constraints nullable="false"/>
            </column>
            <column name="private_land_size" type="DOUBLE" defaultValueNumeric="0">
                <constraints nullable="false"/>
            </column>
            <column name="private_water_size" type="DOUBLE" defaultValueNumeric="0">
                <constraints nullable="false"/>
            </column>
        </addColumn>
    </changeSet>

    <changeSet id="2019-04-16-modify-application-number-check" author="vincit-kyostihe">
        <sql dbms="postgresql"><![CDATA[
            ALTER TABLE harvest_permit_application DROP CONSTRAINT ck_harvest_permit_application_delivery_address_not_null_after_send;
        ]]></sql>

        <sql><![CDATA[
            ALTER TABLE harvest_permit_application DROP CONSTRAINT harvest_permit_application_application_number_check;
            ALTER TABLE harvest_permit_application ADD CONSTRAINT harvest_permit_application_application_number_check
            CHECK (status = 'DRAFT' OR status = 'HIDDEN' OR application_number IS NOT NULL);

            ALTER TABLE harvest_permit_application DROP CONSTRAINT harvest_permit_application_permit_holder_check;
            ALTER TABLE harvest_permit_application ADD CONSTRAINT harvest_permit_application_permit_holder_check
            CHECK (status = 'DRAFT' OR status = 'HIDDEN' OR (permit_holder_type IS NOT NULL AND permit_holder_name IS NOT NULL));

            ALTER TABLE harvest_permit_application DROP CONSTRAINT harvest_permit_application_submit_date_check;
            ALTER TABLE harvest_permit_application ADD CONSTRAINT harvest_permit_application_submit_date_check
            CHECK (status = 'DRAFT' OR status = 'HIDDEN' OR submit_date IS NOT NULL);

            ALTER TABLE harvest_permit_application ADD CONSTRAINT harvest_permit_application_delivery_address_check
            CHECK (status = 'DRAFT' OR status = 'HIDDEN' OR (
                    delivery_address_recipient IS NOT NULL
                    AND delivery_address_street_address IS NOT NULL
                    AND delivery_address_postal_code IS NOT NULL
                    AND delivery_address_city IS NOT NULL));
        ]]>
        </sql>
    </changeSet>

    <changeSet id="2019-04-18-add-large-carnivore-categories" author="vincit-terole">
        <insert tableName="harvest_permit_category">
            <column name="name" value="LARGE_CARNIVORE_BEAR"></column>
        </insert>
        <insert tableName="harvest_permit_category">
            <column name="name" value="LARGE_CARNIVORE_LYNX"></column>
        </insert>
        <insert tableName="harvest_permit_category">
            <column name="name" value="LARGE_CARNIVORE_LYNX_PORONHOITO"></column>
        </insert>
        <insert tableName="harvest_permit_category">
            <column name="name" value="LARGE_CARNIVORE_WOLF"></column>
        </insert>
    </changeSet>


    <changeSet id="2019-05-06-carnivore-permit-application-table" author="vincit-terole">
        <createTable tableName="carnivore_permit_application">
            <column autoIncrement="true" name="carnivore_permit_application_id" type="BIGSERIAL">
                <constraints primaryKey="true" primaryKeyName="carnivore_permit_application_pkey"/>
            </column>
            <column name="consistency_version" type="INT" defaultValueNumeric="0">
                <constraints nullable="false"/>
            </column>

            <column name="created_by_user_id" type="BIGINT"/>
            <column name="deleted_by_user_id" type="BIGINT"/>
            <column name="modified_by_user_id" type="BIGINT"/>

            <column name="creation_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="modification_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="deletion_time" type="TIMESTAMP WITH TIME ZONE"/>

            <column name="harvest_permit_application_id" type="BIGINT">
                <constraints nullable="false"
                             references="harvest_permit_application(harvest_permit_application_id)"
                             foreignKeyName="fk_carnivore_permit_application_application_id"
                             unique="true"
                             uniqueConstraintName="uk_carnivore_permit_application_parent"/>
            </column>
            <column name="area_size" type="INT"/>
            <column name="latitude" type="INT"/>
            <column name="longitude" type="INT"/>
            <column name="accuracy" type="DOUBLE"/>
            <column name="altitude" type="DOUBLE"/>
            <column name="altitude_accuracy" type="DOUBLE"/>
            <column name="geolocation_source" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>

    <changeSet id="2019-05-10-carnivore-permit-application-area-description" author="vincit-terole">
        <addColumn tableName="carnivore_permit_application">
            <column name="area_description" type="TEXT"></column>
        </addColumn>
    </changeSet>

    <changeSet id="2019-05-09-add-two-justification-fields-into-carnivore-permit-application" author="vincit-jarkkoka">
        <addColumn tableName="carnivore_permit_application">
            <column name="additional_justification_info" type="TEXT"/>
            <column name="alternative_measures" type="TEXT"/>
        </addColumn>
    </changeSet>


    <changeSet id="2019-05-07-add-missing-indexing" author="vincit-kyostihe">
        <createIndex tableName="harvest_permit_area" indexName="ndx_harvest_permit_area_zone_id">
            <column name="zone_id"/>
        </createIndex>

        <createIndex tableName="harvest_permit_application" indexName="ndx_harvest_permit_application_area_id">
            <column name="area_id"/>
        </createIndex>
    </changeSet>

    <changeSet id="2019-05-09-modify-mh-permit-constraints" author="vincit-kyostihe">
        <dropNotNullConstraint tableName="mh_permit" columnName="permit_name" columnDataType="VARCHAR(255)"/>
        <dropNotNullConstraint tableName="mh_permit" columnName="permit_name_swedish" columnDataType="VARCHAR(255)"/>
        <dropNotNullConstraint tableName="mh_permit" columnName="permit_name_english" columnDataType="VARCHAR(255)"/>
        <dropNotNullConstraint tableName="mh_permit" columnName="permit_type" columnDataType="VARCHAR(255)"/>
        <dropNotNullConstraint tableName="mh_permit" columnName="permit_type_swedish" columnDataType="VARCHAR(255)"/>
        <dropNotNullConstraint tableName="mh_permit" columnName="permit_type_english" columnDataType="VARCHAR(255)"/>
        <dropNotNullConstraint tableName="mh_permit" columnName="area_name" columnDataType="VARCHAR(255)"/>
        <dropNotNullConstraint tableName="mh_permit" columnName="area_name_swedish" columnDataType="VARCHAR(255)"/>
        <dropNotNullConstraint tableName="mh_permit" columnName="area_name_english" columnDataType="VARCHAR(255)"/>

        <createIndex tableName="mh_permit" indexName="uk_mh_permit_permit_dentifier" unique="true">
            <column name="permit_identifier"/>
        </createIndex>
    </changeSet>

    <changeSet id="2019-05-03-add-responsible-to-shooting-test-official" author="vincit-mikkori">
        <addColumn tableName="shooting_test_official">
            <column name="shooting_test_responsible" type="BOOLEAN"/>
        </addColumn>

        <createIndex tableName="shooting_test_official"
                     indexName="ndx_shooting_test_official_responsible_shooting_test_event_id"
                     unique="true">
            <column name="shooting_test_responsible"/>
            <column name="shooting_test_event_id"/>
        </createIndex>
    </changeSet>

    <changeSet id="2019-05-15-add-population-preservation-reason" author="vincit-terole">
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_POPULATION_PRESERVATION"/>
        </insert>
    </changeSet>

    <changeSet id="2019-05-20-add-youth-trainings-last-modified-to-rhy-annual-statistics" author="vincit-mikkori">
        <addColumn tableName="rhy_annual_statistics">
            <column name="youth_trainings_last_modified" type="TIMESTAMP WITH TIME ZONE"/>
        </addColumn>
    </changeSet>

    <changeSet id="2019-05-20-insert-youth-training-to-rhy_annual_statistics_editable_data_group-table"
               author="vincit-mikkori">
        <insert tableName="rhy_annual_statistics_editable_data_group">
            <column name="name" value="YOUTH_TRAINING"/>
        </insert>
    </changeSet>

    <changeSet id="2019-06-05-rename-columns-in-rhy_annual_statistics" author="vincit-mikkori">
        <renameColumn tableName="rhy_annual_statistics"
                      oldColumnName="state_aid_hunter_trainings_last_modified"
                      newColumnName="hunter_trainings_last_modified"/>
        <renameColumn tableName="rhy_annual_statistics"
                      oldColumnName="other_shooting_training_events"
                      newColumnName="shooting_training_events"/>
        <renameColumn tableName="rhy_annual_statistics"
                      oldColumnName="other_shooting_training_participants"
                      newColumnName="shooting_training_participants"/>
        <renameColumn tableName="rhy_annual_statistics"
                      oldColumnName="other_training_events"
                      newColumnName="public_events"/>
        <renameColumn tableName="rhy_annual_statistics"
                      oldColumnName="other_training_participants"
                      newColumnName="public_event_participants"/>
        <renameColumn tableName="rhy_annual_statistics"
                      oldColumnName="other_training_last_modified"
                      newColumnName="public_events_last_modified"/>
        <renameColumn tableName="rhy_annual_statistics"
                      oldColumnName="moose_taxation_planning_events"
                      newColumnName="mooselike_taxation_planning_events"/>
        <renameColumn tableName="rhy_annual_statistics"
                      oldColumnName="wolf_territory_workgroup_leads"
                      newColumnName="wolf_territory_workgroups"/>

        <sql><![CDATA[
            ALTER TABLE rhy_annual_statistics RENAME CONSTRAINT ck_rhy_annual_report_other_shooting_training_events TO ck_rhy_annual_statistics_shooting_training_events;
            ALTER TABLE rhy_annual_statistics RENAME CONSTRAINT ck_rhy_annual_report_other_other_shooting_training_participants TO ck_rhy_annual_statistics_shooting_training_participants;
            ALTER TABLE rhy_annual_statistics RENAME CONSTRAINT ck_rhy_annual_report_other_training_events TO ck_rhy_annual_statistics_public_events;
            ALTER TABLE rhy_annual_statistics RENAME CONSTRAINT ck_rhy_annual_report_other_training_participants TO ck_rhy_annual_statistics_public_event_participants;
            ALTER TABLE rhy_annual_statistics RENAME CONSTRAINT ck_rhy_annual_statistics_moose_taxation_planning_events TO ck_rhy_annual_statistics_mooselike_taxation_planning_events;
            ALTER TABLE rhy_annual_statistics RENAME CONSTRAINT ck_rhy_annual_report_wolf_territory_workgroup_leads TO ck_rhy_annual_statistics_wolf_territory_workgroups;
        ]]></sql>
    </changeSet>

    <changeSet id="2019-05-15-add-end-of-hunting-report-comments-to-harvest-permit" author="vincit-mikkori">
        <addColumn tableName="harvest_permit">
            <column name="end_of_hunting_report_comments" type="TEXT"/>
        </addColumn>
    </changeSet>

    <changeSet id="2019-06-12-add-public_visibility-in-calendar_event" author="vincit-mikkori">
        <addColumn tableName="calendar_event">
            <column name="public_visibility" type="BOOLEAN" defaultValueBoolean="true">
                <constraints nullable="false"/>
            </column>
        </addColumn>
    </changeSet>

    <changeSet id="2019-06-13-add-excluded_from_statistics-in-calendar_event" author="vincit-mikkori">
        <addColumn tableName="calendar_event">
            <column name="excluded_from_statistics" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
        </addColumn>
    </changeSet>

    <changeSet id="2019-08-16-add-new-boolean-field-to-mh-permit" author="vincit-terole">
        <addColumn tableName="mh_permit">
            <column name="harvest_report_submitted" type="BOOLEAN"></column>
        </addColumn>
    </changeSet>

    <changeSet id="2019-06-25-add-conflict-batch" author="vincit-kyostihe">
        <createTable tableName="harvest_permit_application_conflict_batch">
            <column autoIncrement="true" name="harvest_permit_application_conflict_batch_id" type="BIGSERIAL">
                <constraints primaryKey="true" primaryKeyName="harvest_permit_application_conflict_batch_pkey"/>
            </column>
            <column name="consistency_version" type="INT" defaultValueNumeric="0">
                <constraints nullable="false"/>
            </column>

            <column name="created_by_user_id" type="BIGINT"/>
            <column name="deleted_by_user_id" type="BIGINT"/>
            <column name="modified_by_user_id" type="BIGINT"/>

            <column name="creation_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="modification_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="deletion_time" type="TIMESTAMP WITH TIME ZONE"/>

            <column name="hunting_year" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="completed_at" type="TIMESTAMP WITH TIME ZONE"/>
        </createTable>

        <dropForeignKeyConstraint baseTableName="harvest_permit_application_conflict"
                                  constraintName="fk_harvest_permit_application_conflict_first"/>

        <dropForeignKeyConstraint baseTableName="harvest_permit_application_conflict"
                                  constraintName="fk_harvest_permit_application_conflict_second"/>

        <dropIndex tableName="harvest_permit_application_conflict"
                   indexName="ndx_harvest_permit_application_conflict"/>

        <dropIndex tableName="harvest_permit_application_conflict_palsta"
                   indexName="ndx_harvest_permit_application_conflict_palsta"/>

        <addColumn tableName="harvest_permit_application_conflict">
            <column name="batch_id" type="BIGINT">
                <constraints foreignKeyName="fk_harvest_permit_application_conflict_batch_id"
                             references="harvest_permit_application_conflict_batch(harvest_permit_application_conflict_batch_id)"/>
            </column>
        </addColumn>

        <addColumn tableName="harvest_permit_application_conflict_palsta">
            <column name="batch_id" type="BIGINT">
                <constraints foreignKeyName="fk_harvest_permit_application_conflict_palsta_batch_id"
                             references="harvest_permit_application_conflict_batch(harvest_permit_application_conflict_batch_id)"/>
            </column>
        </addColumn>

        <sql dbms="postgresql"><![CDATA[
        INSERT INTO harvest_permit_application_conflict_batch (hunting_year) VALUES (2019);

        UPDATE harvest_permit_application_conflict SET batch_id = (
            SELECT MAX(harvest_permit_application_conflict_batch_id) FROM harvest_permit_application_conflict_batch);

        UPDATE harvest_permit_application_conflict_palsta SET batch_id = (
            SELECT MAX(harvest_permit_application_conflict_batch_id) FROM harvest_permit_application_conflict_batch);
        ]]></sql>

        <addNotNullConstraint tableName="harvest_permit_application_conflict"
                              columnName="batch_id" columnDataType="BIGINT"/>

        <addNotNullConstraint tableName="harvest_permit_application_conflict_palsta"
                              columnName="batch_id" columnDataType="BIGINT"/>

        <createIndex tableName="harvest_permit_application_conflict"
                     indexName="ndx_harvest_permit_application_conflict_first">
            <column name="batch_id"/>
            <column name="first_application_id"/>
        </createIndex>

        <createIndex tableName="harvest_permit_application_conflict_palsta"
                     indexName="ndx_harvest_permit_application_conflict_palsta_first_second">
            <column name="batch_id"/>
            <column name="first_application_id"/>
            <column name="second_application_id"/>
        </createIndex>

        <addForeignKeyConstraint constraintName="fk_harvest_permit_application_conflict_first"
                                 baseTableName="harvest_permit_application_conflict"
                                 baseColumnNames="first_application_id"
                                 referencedTableName="harvest_permit_application"
                                 referencedColumnNames="harvest_permit_application_id"/>

        <addForeignKeyConstraint constraintName="fk_harvest_permit_application_conflict_second"
                                 baseTableName="harvest_permit_application_conflict"
                                 baseColumnNames="first_application_id"
                                 referencedTableName="harvest_permit_application"
                                 referencedColumnNames="harvest_permit_application_id"/>
    </changeSet>

    <changeSet id="2019-05-29-add-table-for-harvest-registry" author="vincit-terole">
        <createTable tableName="harvest_registry_item">
            <column autoIncrement="true" name="harvest_registry_item_id" type="BIGSERIAL">
                <constraints primaryKey="true" primaryKeyName="harvest_registry_item_pkey"/>
            </column>
            <column name="consistency_version" type="INT" defaultValueNumeric="0">
                <constraints nullable="false"/>
            </column>

            <column name="created_by_user_id" type="BIGINT"/>
            <column name="deleted_by_user_id" type="BIGINT"/>
            <column name="modified_by_user_id" type="BIGINT"/>

            <column name="creation_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="modification_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="deletion_time" type="TIMESTAMP WITH TIME ZONE"/>
            <column name="harvest_id" type="BIGINT">
                <constraints references="harvest(harvest_id)"
                             foreignKeyName="fk_harvest_registry_item_harvest" nullable="false"></constraints>
            </column>
            <column name="shooter_name" type="VARCHAR(255)">
                <constraints nullable="false"></constraints>
            </column>
            <column name="shooter_address_street_address" type="VARCHAR(255)"></column>
            <column name="shooter_address_postal_code" type="VARCHAR(255)"></column>
            <column name="shooter_address_city" type="VARCHAR(255)"></column>
            <column name="shooter_address_country" type="VARCHAR(255)"></column>

            <column name="shooter_hunter_number" type="VARCHAR(255)">
                <constraints nullable="false"></constraints>
            </column>
            <column name="point_of_time" type="TIMESTAMP WITH TIME ZONE">
                <constraints nullable="false"></constraints>
            </column>
            <column name="game_species_id" type="BIGINT">
                <constraints nullable="false" references="game_species(game_species_id)"
                             foreignKeyName="fk_harvest_registry_item_game_species"/>
            </column>
            <column name="amount" type="INT">
            </column>
            <column name="gender" type="VARCHAR(255)">
                <constraints references="game_gender(name)"
                             foreignKeyName="fk_harvest_registry_item_gender"/>
            </column>
            <column name="age" type="VARCHAR(255)">
                <constraints references="game_age(name)"
                             foreignKeyName="fk_harvest_registry_item_age"/>
            </column>
            <column name="weight" type="DECIMAL(5,2)"/>

            <column name="latitude" type="INT"/>
            <column name="longitude" type="INT"/>
            <column name="accuracy" type="DOUBLE"/>
            <column name="altitude" type="DOUBLE"/>
            <column name="altitude_accuracy" type="DOUBLE"/>
            <column name="geolocation_source" type="VARCHAR(255)"/>
            <column name="municipality_code" type="VARCHAR(3)"></column>
            <column name="municipality_finnish" type="VARCHAR(255)"/>
            <column name="municipality_swedish" type="VARCHAR(255)"/>
            <column name="harvest_area_finnish" type="VARCHAR(255)"/>
            <column name="harvest_area_swedish" type="VARCHAR(255)"/>
            <column name="rka_code" type="VARCHAR(3)"></column>
            <column name="rka_finnish" type="VARCHAR(255)"/>
            <column name="rka_swedish" type="VARCHAR(255)"/>
            <column name="rhy_code" type="VARCHAR(3)"></column>
            <column name="rhy_finnish" type="VARCHAR(255)"/>
            <column name="rhy_swedish" type="VARCHAR(255)"/>
        </createTable>

        <createIndex tableName="harvest_registry_item" indexName="idx_harvest_registry_item_harvest_id">
            <column name="harvest_id"></column>
        </createIndex>
    </changeSet>

    <changeSet id="2019-08-07-foreigners-to-person-table" author="vincit-terole">
        <dropNotNullConstraint tableName="person" columnName="ssn" columnDataType="VARCHAR(11)"/>
        <addColumn tableName="person">
            <column name="date_of_birth" type="date"></column>
        </addColumn>
        <sql dbms="postgresql"><![CDATA[
            INSERT INTO person(hunter_number, first_name, by_name, last_name, date_of_birth)
                (SELECT fp.hunter_number, fp.first_name, fp.first_name, fp.last_name, fp.date_of_birth
                FROM foreign_person fp
                LEFT JOIN person p ON p.hunter_number = fp.hunter_number
                WHERE p.ssn IS NULL);

            ALTER TABLE shooting_test_participant DROP CONSTRAINT ck_shooting_test_participant_person;

            UPDATE shooting_test_participant updated
            SET person_id         = sub.person_id
            FROM (SELECT stp.shooting_test_participant_id, p.person_id
                  FROM shooting_test_participant stp
                           INNER JOIN foreign_person fp ON stp.foreign_person_id = fp.foreign_person_id
                           INNER JOIN person p ON p.hunter_number = fp.hunter_number
                  WHERE stp.foreign_person_id IS NOT NULL) AS sub
            WHERE sub.shooting_test_participant_id = updated.shooting_test_participant_id;
        ]]></sql>

        <addNotNullConstraint tableName="shooting_test_participant" columnName="person_id" columnDataType="BIGINT"/>

        <sql><![CDATA[
             ALTER TABLE person ADD CONSTRAINT ck_person_ssn_or_dob_not_null_check
            CHECK ((ssn IS NOT NULL) OR (date_of_birth IS NOT NULL));
        ]]></sql>

    </changeSet>

    <changeSet id="2019-09-06-drop-not-null-constraint-harvest-registry-item-shooternumber" author="vincit-terole">
        <dropNotNullConstraint tableName="harvest_registry_item" columnName="shooter_hunter_number"
                               columnDataType="VARCHAR(255)"/>
    </changeSet>


    <changeSet id="2019-08-29-personal-area-union-table" author="vincit-terole">
        <createTable tableName="personal_area_union">
            <column autoIncrement="true" name="personal_area_union_id" type="BIGSERIAL">
                <constraints primaryKey="true" primaryKeyName="personal_area_union_pkey"/>
            </column>
            <column name="consistency_version" type="INT" defaultValueNumeric="0">
                <constraints nullable="false"/>
            </column>

            <column name="created_by_user_id" type="BIGINT"/>
            <column name="deleted_by_user_id" type="BIGINT"/>
            <column name="modified_by_user_id" type="BIGINT"/>

            <column name="creation_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="modification_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="deletion_time" type="TIMESTAMP WITH TIME ZONE"/>
            <column name="person_id" type="BIGINT">
                <constraints nullable="false"
                             references="person(person_id)"
                             foreignKeyName="fk_personal_area_union_person_id"/>
            </column>
            <column name="harvest_permit_area_id" type="BIGINT">
                <constraints nullable="false"
                             references="harvest_permit_area(harvest_permit_area_id)"
                             foreignKeyName="fk_personal_area_union_harvest_permit_area_id"/>
            </column>
            <column name="name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <createIndex tableName="personal_area_union" indexName="ndx_personal_area_union_person_id">
            <column name="person_id"/>
        </createIndex>
    </changeSet>

    <changeSet id="2019-08-23-add-indexing-for-mh-permit-types" author="vincit-terole">
        <createIndex tableName="mh_permit" indexName="ndx_mh_permit_permit_type">
            <column name="permit_type"></column>
        </createIndex>
        <createIndex tableName="mh_permit" indexName="ndx_mh_permit_permit_type_swedish">
            <column name="permit_type_swedish"></column>
        </createIndex>
        <createIndex tableName="mh_permit" indexName="ndx_mh_permit_begin_date">
            <column name="begin_date"></column>
        </createIndex>
        <createIndex tableName="mh_permit" indexName="ndx_mh_permit_end_date">
            <column name="end_date"></column>
        </createIndex>
    </changeSet>

    <changeSet id="2019-06-11-add-missing-index" author="vincit-kyostihe">
        <createIndex tableName="mobile_client_device" indexName="ndx_mobile_client_device_person_id">
            <column name="person_id"/>
        </createIndex>
    </changeSet>

    <changeSet id="2019-06-24-add-participants-to-calendar_event" author="vincit-mikkori">
        <addColumn tableName="calendar_event">
            <column name="participants" type="INT"/>
        </addColumn>
    </changeSet>

    <changeSet id="2019-06-25-add-hunter_exam_training_participants_overridden-to-rhy_annual_statistics" author="vincit-mikkori">
        <addColumn tableName="rhy_annual_statistics">
            <column name="hunter_exam_training_participants_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
        </addColumn>

        <sql dbms="postgresql"><![CDATA[
            UPDATE rhy_annual_statistics SET hunter_exam_training_participants_overridden = true WHERE hunter_exam_training_participants IS NOT NULL;
        ]]></sql>
    </changeSet>

    <changeSet id="2019-06-26-add-new-types-in-calendar_event_type" author="vincit-mikkori">
        <insert tableName="calendar_event_type">
            <column name="name" value="METSASTYKSENJOHTAJA_HIRVIELAIMET"/>
        </insert>
        <insert tableName="calendar_event_type">
            <column name="name" value="METSASTYKSENJOHTAJA_SUURPEDOT"/>
        </insert>
        <insert tableName="calendar_event_type">
            <column name="name" value="METSASTAJAKOULUTUS_HIRVIELAIMET"/>
        </insert>
        <insert tableName="calendar_event_type">
            <column name="name" value="METSASTAJAKOULUTUS_SUURPEDOT"/>
        </insert>
        <insert tableName="calendar_event_type">
            <column name="name" value="SRVAKOULUTUS"/>
        </insert>
        <insert tableName="calendar_event_type">
            <column name="name" value="PETOYHDYSHENKILO_KOULUTUS"/>
        </insert>
        <insert tableName="calendar_event_type">
            <column name="name" value="VAHINKOKOULUTUS"/>
        </insert>
        <insert tableName="calendar_event_type">
            <column name="name" value="TILAISUUS_KOULUILLE"/>
        </insert>
        <insert tableName="calendar_event_type">
            <column name="name" value="OPPILAITOSTILAISUUS"/>
        </insert>
        <insert tableName="calendar_event_type">
            <column name="name" value="NUORISOTILAISUUS"/>
        </insert>
        <insert tableName="calendar_event_type">
            <column name="name" value="AMPUMAKOKEENVASTAANOTTAJA_KOULUTUS"/>
        </insert>
        <insert tableName="calendar_event_type">
            <column name="name" value="METSASTAJATUTKINNONVASTAANOTTAJA_KOULUTUS"/>
        </insert>
        <insert tableName="calendar_event_type">
            <column name="name" value="RIISTAVAHINKOTARKASTAJA_KOULUTUS"/>
        </insert>
        <insert tableName="calendar_event_type">
            <column name="name" value="METSASTYKSENVALVOJA_KOULUTUS"/>
        </insert>
        <insert tableName="calendar_event_type">
            <column name="name" value="PIENPETOJEN_PYYNTI_KOULUTUS"/>
        </insert>
        <insert tableName="calendar_event_type">
            <column name="name" value="RIISTALASKENTA_KOULUTUS"/>
        </insert>
        <insert tableName="calendar_event_type">
            <column name="name" value="RIISTAKANTOJEN_HOITO_KOULUTUS"/>
        </insert>
        <insert tableName="calendar_event_type">
            <column name="name" value="RIISTAN_ELINYMPARISTON_HOITO_KOULUTUS"/>
        </insert>
        <insert tableName="calendar_event_type">
            <column name="name" value="MUU_RIISTANHOITOKOULUTUS"/>
        </insert>
        <insert tableName="calendar_event_type">
            <column name="name" value="AMPUMAKOULUTUS"/>
        </insert>
        <insert tableName="calendar_event_type">
            <column name="name" value="JALJESTAJAKOULUTUS"/>
        </insert>
        <insert tableName="calendar_event_type">
            <column name="name" value="MUU_TAPAHTUMA"/>
        </insert>
        <insert tableName="calendar_event_type">
            <column name="name" value="RHY_HALLITUKSEN_KOKOUS"/>
        </insert>
    </changeSet>

    <changeSet id="2019-06-26-add-hunter-training-statistics-override-fields-to-rhy_annual_statistics" author="vincit-mikkori">
        <addColumn tableName="rhy_annual_statistics">
            <column name="mooselike_hunting_training_events_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="mooselike_hunting_training_participants_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false" />
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="mooselike_hunting_leader_training_events_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false" />
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="mooselike_hunting_leader_training_participants_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false" />
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="carnivore_hunting_training_events_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false" />
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="carnivore_hunting_training_participants_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false" />
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="carnivore_hunting_leader_training_events_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false" />
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="carnivore_hunting_leader_training_participants_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false" />
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="srva_training_events_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="srva_training_participants_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="carnivore_contact_person_training_events_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false" />
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="carnivore_contact_person_training_participants_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false" />
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="accident_prevention_training_events_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false" />
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="accident_prevention_training_participants_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false" />
            </column>
        </addColumn>

        <sql dbms="postgresql"><![CDATA[
            UPDATE rhy_annual_statistics SET mooselike_hunting_training_events_overridden = true WHERE mooselike_hunting_training_events IS NOT NULL;
            UPDATE rhy_annual_statistics SET mooselike_hunting_training_participants_overridden = true WHERE mooselike_hunting_training_participants IS NOT NULL;
            UPDATE rhy_annual_statistics SET mooselike_hunting_leader_training_events_overridden = true WHERE mooselike_hunting_leader_training_events IS NOT NULL;
            UPDATE rhy_annual_statistics SET mooselike_hunting_leader_training_participants_overridden = true WHERE mooselike_hunting_leader_training_participants IS NOT NULL;
            UPDATE rhy_annual_statistics SET carnivore_hunting_training_events_overridden = true WHERE carnivore_hunting_training_events IS NOT NULL;
            UPDATE rhy_annual_statistics SET carnivore_hunting_training_participants_overridden = true WHERE carnivore_hunting_training_participants IS NOT NULL;
            UPDATE rhy_annual_statistics SET carnivore_hunting_leader_training_events_overridden = true WHERE carnivore_hunting_leader_training_events IS NOT NULL;
            UPDATE rhy_annual_statistics SET carnivore_hunting_leader_training_participants_overridden = true WHERE carnivore_hunting_leader_training_participants IS NOT NULL;
            UPDATE rhy_annual_statistics SET srva_training_events_overridden = true WHERE srva_training_events IS NOT NULL;
            UPDATE rhy_annual_statistics SET srva_training_participants_overridden = true WHERE srva_training_participants IS NOT NULL;
            UPDATE rhy_annual_statistics SET carnivore_contact_person_training_events_overridden = true WHERE carnivore_contact_person_training_events IS NOT NULL;
            UPDATE rhy_annual_statistics SET carnivore_contact_person_training_participants_overridden = true WHERE carnivore_contact_person_training_participants IS NOT NULL;
            UPDATE rhy_annual_statistics SET accident_prevention_training_events_overridden = true WHERE accident_prevention_training_events IS NOT NULL;
            UPDATE rhy_annual_statistics SET accident_prevention_training_participants_overridden = true WHERE accident_prevention_training_participants IS NOT NULL;
        ]]></sql>
    </changeSet>

    <changeSet id="2019-06-27-add-youth-training-override-fields-to-rhy_annual_statistics" author="vincit-mikkori">
        <addColumn tableName="rhy_annual_statistics">
            <column name="school_training_events_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="school_training_participants_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="college_training_events_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="college_training_participants_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="other_youth_targeted_training_events_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="other_youth_targeted_training_participants_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false" />
            </column>
        </addColumn>

        <sql dbms="postgresql"><![CDATA[
            UPDATE rhy_annual_statistics SET school_training_events_overridden = true WHERE school_training_events IS NOT NULL;
            UPDATE rhy_annual_statistics SET school_training_participants_overridden = true WHERE school_training_participants IS NOT NULL;
            UPDATE rhy_annual_statistics SET college_training_events_overridden = true WHERE college_training_events IS NOT NULL;
            UPDATE rhy_annual_statistics SET college_training_participants_overridden = true WHERE college_training_participants IS NOT NULL;
            UPDATE rhy_annual_statistics SET other_youth_targeted_training_events_overridden = true WHERE other_youth_targeted_training_events IS NOT NULL;
            UPDATE rhy_annual_statistics SET other_youth_targeted_training_participants_overridden = true WHERE other_youth_targeted_training_participants IS NOT NULL;
        ]]></sql>
    </changeSet>

    <changeSet id="2019-06-27-add-jht-training-override-fields-to-rhy_annual_statistics" author="vincit-mikkori">
        <addColumn tableName="rhy_annual_statistics">
            <column name="jht_shooting_test_training_events_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="jht_shooting_test_training_participants_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false" />
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="jht_hunter_exam_training_events_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="jht_hunter_exam_training_participants_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="jht_game_damage_training_events_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="jht_game_damage_training_participants_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="jht_hunting_control_training_events_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="jht_hunting_control_training_participants_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false" />
            </column>
        </addColumn>

        <sql dbms="postgresql"><![CDATA[
            UPDATE rhy_annual_statistics SET jht_shooting_test_training_events_overridden = true WHERE jht_shooting_test_training_events IS NOT NULL;
            UPDATE rhy_annual_statistics SET jht_shooting_test_training_participants_overridden = true WHERE jht_shooting_test_training_participants IS NOT NULL;
            UPDATE rhy_annual_statistics SET jht_hunter_exam_training_events_overridden = true WHERE jht_hunter_exam_training_events IS NOT NULL;
            UPDATE rhy_annual_statistics SET jht_hunter_exam_training_participants_overridden = true WHERE jht_hunter_exam_training_participants IS NOT NULL;
            UPDATE rhy_annual_statistics SET jht_game_damage_training_events_overridden = true WHERE jht_game_damage_training_events IS NOT NULL;
            UPDATE rhy_annual_statistics SET jht_game_damage_training_participants_overridden = true WHERE jht_game_damage_training_participants IS NOT NULL;
            UPDATE rhy_annual_statistics SET jht_hunting_control_training_events_overridden = true WHERE jht_hunting_control_training_events IS NOT NULL;
            UPDATE rhy_annual_statistics SET jht_hunting_control_training_participants_overridden = true WHERE jht_hunting_control_training_participants IS NOT NULL;
        ]]></sql>
    </changeSet>

    <changeSet id="2019-06-28-add-other-hunting-related-override-fields-to-rhy_annual-statistics" author="vincit-mikkori">
        <addColumn tableName="rhy_annual_statistics">
            <column name="small_carnivore_hunting_training_events_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false" />
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="small_carnivore_hunting_training_participants_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false" />
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="game_counting_training_events_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="game_counting_training_participants_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="game_population_management_training_events_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false" />
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="game_population_management_training_participants_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false" />
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="game_environmental_care_training_events_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false" />
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="game_environmental_care_training_participants_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false" />
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="other_gamekeeping_training_events_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="other_gamekeeping_training_participants_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false" />
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="shooting_training_events_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="shooting_training_participants_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="tracker_training_events_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="tracker_training_participants_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
        </addColumn>

        <sql dbms="postgresql"><![CDATA[
            UPDATE rhy_annual_statistics SET small_carnivore_hunting_training_events_overridden = true WHERE small_carnivore_hunting_training_events IS NOT NULL;
            UPDATE rhy_annual_statistics SET small_carnivore_hunting_training_participants_overridden = true WHERE small_carnivore_hunting_training_participants IS NOT NULL;
            UPDATE rhy_annual_statistics SET game_counting_training_events_overridden = true WHERE game_counting_training_events IS NOT NULL;
            UPDATE rhy_annual_statistics SET game_counting_training_participants_overridden = true WHERE game_counting_training_participants IS NOT NULL;
            UPDATE rhy_annual_statistics SET game_population_management_training_events_overridden = true WHERE game_population_management_training_events IS NOT NULL;
            UPDATE rhy_annual_statistics SET game_population_management_training_participants_overridden = true WHERE game_population_management_training_participants IS NOT NULL;
            UPDATE rhy_annual_statistics SET game_environmental_care_training_events_overridden = true WHERE game_environmental_care_training_events IS NOT NULL;
            UPDATE rhy_annual_statistics SET game_environmental_care_training_participants_overridden = true WHERE game_environmental_care_training_participants IS NOT NULL;
            UPDATE rhy_annual_statistics SET other_gamekeeping_training_events_overridden = true WHERE other_gamekeeping_training_events IS NOT NULL;
            UPDATE rhy_annual_statistics SET other_gamekeeping_training_participants_overridden = true WHERE other_gamekeeping_training_participants IS NOT NULL;
            UPDATE rhy_annual_statistics SET shooting_training_events_overridden = true WHERE shooting_training_events IS NOT NULL;
            UPDATE rhy_annual_statistics SET shooting_training_participants_overridden = true WHERE shooting_training_participants IS NOT NULL;
            UPDATE rhy_annual_statistics SET tracker_training_events_overridden = true WHERE tracker_training_events IS NOT NULL;
            UPDATE rhy_annual_statistics SET tracker_training_participants_overridden = true WHERE tracker_training_participants IS NOT NULL;
        ]]></sql>
    </changeSet>

    <changeSet id="2019-09-23-add-moderator-area" author="vincit-kyostihe">
        <validCheckSum>8:65ad800a6b841cae738991c98b1d56a6</validCheckSum>
        <createTable tableName="moderator_area">
            <column autoIncrement="true" name="moderator_area_id" type="BIGSERIAL">
                <constraints primaryKey="true" primaryKeyName="moderator_area_pkey"/>
            </column>
            <column name="consistency_version" type="INT" defaultValueNumeric="0">
                <constraints nullable="false"/>
            </column>

            <column name="created_by_user_id" type="BIGINT"/>
            <column name="deleted_by_user_id" type="BIGINT"/>
            <column name="modified_by_user_id" type="BIGINT"/>

            <column name="creation_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="modification_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="deletion_time" type="TIMESTAMP WITH TIME ZONE"/>
            <column name="moderator_id" type="BIGINT">
                <constraints nullable="false"
                             referencedTableName="system_user" referencedColumnNames="user_id"
                             foreignKeyName="fk_moderator_area_moderator_id"/>
            </column>
            <column name="rka_id" type="BIGINT">
                <constraints nullable="false"
                             references="organisation(organisation_id)"
                             foreignKeyName="fk_moderator_area_rka_id"/>
            </column>
            <column name="zone_id" type="BIGINT">
                <constraints nullable="false"
                             references="zone(zone_id)"
                             foreignKeyName="fk_zone_zone_id"/>
            </column>
            <column name="name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="year" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="external_id" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <createIndex tableName="moderator_area" indexName="ndx_moderator_area_moderator_id">
            <column name="moderator_id"/>
        </createIndex>

        <createIndex tableName="moderator_area" indexName="ndx_moderator_area_external_id" unique="true">
            <column name="external_id"/>
        </createIndex>
    </changeSet>

    <changeSet id="2019-08-16-additional_calendar_event" author="vincit-mikkori">
        <createTable tableName="additional_calendar_event">
            <column autoIncrement="true" name="additional_calendar_event_id" type="BIGSERIAL">
                <constraints primaryKey="true" primaryKeyName="additional_calendar_event_pkey"/>
            </column>
            <column name="consistency_version" type="INT" defaultValueNumeric="0">
                <constraints nullable="false"/>
            </column>
            <column name="created_by_user_id" type="BIGINT"/>
            <column name="deleted_by_user_id" type="BIGINT"/>
            <column name="modified_by_user_id" type="BIGINT"/>
            <column name="creation_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="modification_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="deletion_time" type="TIMESTAMP WITH TIME ZONE"/>
            <column name="calendar_event_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="venue_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="date" type="TIMESTAMP WITH TIME ZONE">
                <constraints nullable="false"/>
            </column>
            <column name="begin_time" type="TIME WITHOUT TIME ZONE">
                <constraints nullable="false"/>
            </column>
            <column name="end_time" type="TIME WITHOUT TIME ZONE"/>
        </createTable>

        <addForeignKeyConstraint baseTableName="additional_calendar_event" baseColumnNames="calendar_event_id"
                                 constraintName="fk_additional_calendar_event_calendar_event"
                                 referencedTableName="calendar_event" referencedColumnNames="calendar_event_id"
                                 onDelete="CASCADE" onUpdate="NO ACTION"/>

        <addForeignKeyConstraint baseTableName="additional_calendar_event" baseColumnNames="venue_id"
                                 constraintName="fk_additional_calendar_event_venue"
                                 referencedTableName="venue" referencedColumnNames="venue_id"
                                 onUpdate="NO ACTION"/>

        <createIndex tableName="additional_calendar_event"
                     indexName="ndx_additional_calendar_event_calendar_event">
            <column name="calendar_event_id"/>
        </createIndex>

        <createIndex tableName="additional_calendar_event"
                     indexName="ndx_additional_calendar_event_venue">
            <column name="venue_id"/>
        </createIndex>
    </changeSet>

    <changeSet id="2019-09-16-insert-rhy-nuts-area-ids" author="vincit-nikooj">
        <addColumn tableName="rhy">
            <column name="nuts2_id" type="VARCHAR(4)"/>
            <column name="nuts3_id" type="VARCHAR(5)"/>
        </addColumn>
        <sql dbms="postgresql"><![CDATA[
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C3' WHERE id='001';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C2' WHERE id='002';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C2' WHERE id='003';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C2' WHERE id='005';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C2' WHERE id='007';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C2' WHERE id='008';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C3' WHERE id='009';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C2' WHERE id='010';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI197' WHERE id='016';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D1' WHERE id='064';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D1' WHERE id='065';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI193' WHERE id='105';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI193' WHERE id='106';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI193' WHERE id='107';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI193' WHERE id='112';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI193' WHERE id='115';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI193' WHERE id='116';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI193' WHERE id='117';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI193' WHERE id='121';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C4' WHERE id='152';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C4' WHERE id='154';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C4' WHERE id='155';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D7' WHERE id='214';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D7' WHERE id='216';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D7' WHERE id='218';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D7' WHERE id='219';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D7' WHERE id='220';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C4' WHERE id='157';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C5' WHERE id='159';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C4' WHERE id='161';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C5' WHERE id='162';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C5' WHERE id='163';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C5' WHERE id='164';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C4' WHERE id='165';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C4' WHERE id='166';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C4' WHERE id='168';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D2' WHERE id='466';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D2' WHERE id='467';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D2' WHERE id='468';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C4' WHERE id='169';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D7' WHERE id='201';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D7' WHERE id='202';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D7' WHERE id='203';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D7' WHERE id='206';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D7' WHERE id='213';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D9' WHERE id='253';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D9' WHERE id='254';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D9' WHERE id='260';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D9' WHERE id='262';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D9' WHERE id='264';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D9' WHERE id='265';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D9' WHERE id='267';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D9' WHERE id='268';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D9' WHERE id='270';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D9' WHERE id='271';
            UPDATE rhy SET nuts2_id='FI1B', nuts3_id='FI1B1' WHERE id='608';
            UPDATE rhy SET nuts2_id='FI1B', nuts3_id='FI1B1' WHERE id='610';
            UPDATE rhy SET nuts2_id='FI1B', nuts3_id='FI1B1' WHERE id='611';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C3' WHERE id='612';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C1' WHERE id='666';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D9' WHERE id='273';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D9' WHERE id='274';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D9' WHERE id='276';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D9' WHERE id='280';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D9' WHERE id='281';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D9' WHERE id='282';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI194' WHERE id='301';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI194' WHERE id='309';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D5' WHERE id='311';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI197' WHERE id='380';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D3' WHERE id='402';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D3' WHERE id='403';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D3' WHERE id='404';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D3' WHERE id='406';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D3' WHERE id='407';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D3' WHERE id='408';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D3' WHERE id='410';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D3' WHERE id='411';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D3' WHERE id='413';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D3' WHERE id='414';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D2' WHERE id='451';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D2' WHERE id='452';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D2' WHERE id='453';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D2' WHERE id='456';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D2' WHERE id='457';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D2' WHERE id='458';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D2' WHERE id='459';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D2' WHERE id='460';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D2' WHERE id='464';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI194' WHERE id='312';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI194' WHERE id='315';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI195' WHERE id='317';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D5' WHERE id='318';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI194' WHERE id='321';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI194' WHERE id='322';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D5' WHERE id='324';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D5' WHERE id='331';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI197' WHERE id='352';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI197' WHERE id='354';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI195' WHERE id='507';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI196' WHERE id='551';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI197' WHERE id='555';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI197' WHERE id='556';
            UPDATE rhy SET nuts2_id='FI1B', nuts3_id='FI1B1' WHERE id='603';
            UPDATE rhy SET nuts2_id='FI1B', nuts3_id='FI1B1' WHERE id='605';
            UPDATE rhy SET nuts2_id='FI1B', nuts3_id='FI1B1' WHERE id='607';
            UPDATE rhy SET nuts2_id='FI1B', nuts3_id='FI1B1' WHERE id='621';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C1' WHERE id='656';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C1' WHERE id='657';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C1' WHERE id='658';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C1' WHERE id='659';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C1' WHERE id='660';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C1' WHERE id='661';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C1' WHERE id='663';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C1' WHERE id='664';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C1' WHERE id='665';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C1' WHERE id='668';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C1' WHERE id='669';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D8' WHERE id='705';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D8' WHERE id='706';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D1' WHERE id='066';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D1' WHERE id='068';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D1' WHERE id='069';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D1' WHERE id='070';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D1' WHERE id='071';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D1' WHERE id='072';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D8' WHERE id='704';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C2' WHERE id='011';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C2' WHERE id='004';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D7' WHERE id='215';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C2' WHERE id='006';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D9' WHERE id='259';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI193' WHERE id='114';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C3' WHERE id='012';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C2' WHERE id='013';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D1' WHERE id='051';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D1' WHERE id='052';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C3' WHERE id='053';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C3' WHERE id='055';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D1' WHERE id='056';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D1' WHERE id='057';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D1' WHERE id='058';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D1' WHERE id='059';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D2' WHERE id='060';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D1' WHERE id='061';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D1' WHERE id='062';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D1' WHERE id='063';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C3' WHERE id='073';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D1' WHERE id='076';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D1' WHERE id='077';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI193' WHERE id='101';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI193' WHERE id='102';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI193' WHERE id='103';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI193' WHERE id='104';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI193' WHERE id='108';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI193' WHERE id='109';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI193' WHERE id='110';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI193' WHERE id='118';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI193' WHERE id='111';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI193' WHERE id='113';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI193' WHERE id='119';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D9' WHERE id='263';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI193' WHERE id='120';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D5' WHERE id='304';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C4' WHERE id='151';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D5' WHERE id='323';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C5' WHERE id='153';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C5' WHERE id='156';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D5' WHERE id='326';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C5' WHERE id='158';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C4' WHERE id='160';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C5' WHERE id='167';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C5' WHERE id='170';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D7' WHERE id='204';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D7' WHERE id='205';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D7' WHERE id='207';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D7' WHERE id='208';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D7' WHERE id='209';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D7' WHERE id='210';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D7' WHERE id='211';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI194' WHERE id='334';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D7' WHERE id='212';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D7' WHERE id='217';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI197' WHERE id='356';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D9' WHERE id='251';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D9' WHERE id='252';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D9' WHERE id='256';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D9' WHERE id='258';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D9' WHERE id='266';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D9' WHERE id='275';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D9' WHERE id='279';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D3' WHERE id='412';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D9' WHERE id='283';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI194' WHERE id='302';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI194' WHERE id='303';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D9' WHERE id='305';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D3' WHERE id='415';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D2' WHERE id='454';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI194' WHERE id='306';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI194' WHERE id='307';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI194' WHERE id='308';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI194' WHERE id='310';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D2' WHERE id='473';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D2' WHERE id='474';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI195' WHERE id='501';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI195' WHERE id='502';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI195' WHERE id='503';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI194' WHERE id='313';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI196' WHERE id='569';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D5' WHERE id='314';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI194' WHERE id='316';
            UPDATE rhy SET nuts2_id='FI1B', nuts3_id='FI1B1' WHERE id='619';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI195' WHERE id='319';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI194' WHERE id='320';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI194' WHERE id='327';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI194' WHERE id='329';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D5' WHERE id='330';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI194' WHERE id='332';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI194' WHERE id='333';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI193' WHERE id='358';
            UPDATE rhy SET nuts2_id='FI1B', nuts3_id='FI1B1' WHERE id='620';
            UPDATE rhy SET nuts2_id='FI1B', nuts3_id='FI1B1' WHERE id='622';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI197' WHERE id='360';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI197' WHERE id='362';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI197' WHERE id='364';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI197' WHERE id='366';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI197' WHERE id='368';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI197' WHERE id='370';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI197' WHERE id='372';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI197' WHERE id='374';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI197' WHERE id='376';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI197' WHERE id='378';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D3' WHERE id='401';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D3' WHERE id='405';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D3' WHERE id='409';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D2' WHERE id='455';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D2' WHERE id='461';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D2' WHERE id='462';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D2' WHERE id='463';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D2' WHERE id='465';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D2' WHERE id='469';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D2' WHERE id='470';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D2' WHERE id='471';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D2' WHERE id='472';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI195' WHERE id='504';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI195' WHERE id='505';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI195' WHERE id='506';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI195' WHERE id='508';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI196' WHERE id='553';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI196' WHERE id='554';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI197' WHERE id='557';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI196' WHERE id='558';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI196' WHERE id='559';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI196' WHERE id='560';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI196' WHERE id='561';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI197' WHERE id='562';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI196' WHERE id='563';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI197' WHERE id='564';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI196' WHERE id='565';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI196' WHERE id='566';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI197' WHERE id='567';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI197' WHERE id='568';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI196' WHERE id='570';
            UPDATE rhy SET nuts2_id='FI1B', nuts3_id='FI1B1' WHERE id='626';
            UPDATE rhy SET nuts2_id='FI19', nuts3_id='FI196' WHERE id='571';
            UPDATE rhy SET nuts2_id='FI1B', nuts3_id='FI1B1' WHERE id='601';
            UPDATE rhy SET nuts2_id='FI1B', nuts3_id='FI1B1' WHERE id='602';
            UPDATE rhy SET nuts2_id='FI1B', nuts3_id='FI1B1' WHERE id='604';
            UPDATE rhy SET nuts2_id='FI1B', nuts3_id='FI1B1' WHERE id='627';
            UPDATE rhy SET nuts2_id='FI1B', nuts3_id='FI1B1' WHERE id='606';
            UPDATE rhy SET nuts2_id='FI1B', nuts3_id='FI1B1' WHERE id='609';
            UPDATE rhy SET nuts2_id='FI1B', nuts3_id='FI1B1' WHERE id='613';
            UPDATE rhy SET nuts2_id='FI1B', nuts3_id='FI1B1' WHERE id='614';
            UPDATE rhy SET nuts2_id='FI1B', nuts3_id='FI1B1' WHERE id='615';
            UPDATE rhy SET nuts2_id='FI1B', nuts3_id='FI1B1' WHERE id='616';
            UPDATE rhy SET nuts2_id='FI1B', nuts3_id='FI1B1' WHERE id='628';
            UPDATE rhy SET nuts2_id='FI1B', nuts3_id='FI1B1' WHERE id='617';
            UPDATE rhy SET nuts2_id='FI1B', nuts3_id='FI1B1' WHERE id='623';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D8' WHERE id='701';
            UPDATE rhy SET nuts2_id='FI1B', nuts3_id='FI1B1' WHERE id='624';
            UPDATE rhy SET nuts2_id='FI1B', nuts3_id='FI1B1' WHERE id='625';
            UPDATE rhy SET nuts2_id='FI1B', nuts3_id='FI1B1' WHERE id='629';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D8' WHERE id='703';
            UPDATE rhy SET nuts2_id='FI1B', nuts3_id='FI1B1' WHERE id='630';
            UPDATE rhy SET nuts2_id='FI1B', nuts3_id='FI1B1' WHERE id='631';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C1' WHERE id='651';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C1' WHERE id='652';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C1' WHERE id='653';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C1' WHERE id='654';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C1' WHERE id='655';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C1' WHERE id='662';
            UPDATE rhy SET nuts2_id='FI1C', nuts3_id='FI1C1' WHERE id='667';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D8' WHERE id='702';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D8' WHERE id='707';
            UPDATE rhy SET nuts2_id='FI1D', nuts3_id='FI1D8' WHERE id='708';
        ]]></sql>
    </changeSet>

    <changeSet id="2019-10-09-occupation_board_representation_roles" author="vincit-mikkori">
        <createTable tableName="occupation_board_representation_role">
            <column name="name" type="VARCHAR(255)">
                <constraints primaryKey="true"/>
            </column>
        </createTable>

        <insert tableName="occupation_board_representation_role">
            <column name="name" value="METSAHALLITUKSEN_EDUSTAJA"/>
        </insert>
        <insert tableName="occupation_board_representation_role">
            <column name="name" value="MAANOMISTAJIEN_EDUSTAJA"/>
        </insert>
        <insert tableName="occupation_board_representation_role">
            <column name="name" value="METSAHALLITUKSEN_VARAEDUSTAJA"/>
        </insert>
        <insert tableName="occupation_board_representation_role">
            <column name="name" value="MAANOMISTAJIEN_VARAEDUSTAJA"/>
        </insert>
    </changeSet>

    <changeSet id="2019-10-09-add-board_representation-to-occupation" author="vincit-mikkori">
        <addColumn tableName="occupation">
            <column name="board_representation" type="VARCHAR(255)">
                <constraints references="occupation_board_representation_role(name)"
                             foreignKeyName="fk_occupation_board_representation_role"/>
            </column>
        </addColumn>

        <addUniqueConstraint tableName="occupation"
                             columnNames="board_representation, organisation_id"
                             constraintName="uk_board_representation"/>
    </changeSet>

    <changeSet id="2019-09-17-add-mammal-category" author="vincit-terole">
        <insert tableName="harvest_permit_category">
            <column name="name" value="MAMMAL"/>
        </insert>
    </changeSet>

    <changeSet id="2019-09-19-mammal-permit-application-table" author="vincit-terole">
        <createTable tableName="mammal_permit_application">
            <column autoIncrement="true" name="mammal_permit_application_id" type="BIGSERIAL">
                <constraints primaryKey="true" primaryKeyName="mammal_permit_application_pkey"/>
            </column>
            <column name="consistency_version" type="INT" defaultValueNumeric="0">
                <constraints nullable="false"/>
            </column>

            <column name="created_by_user_id" type="BIGINT"/>
            <column name="deleted_by_user_id" type="BIGINT"/>
            <column name="modified_by_user_id" type="BIGINT"/>

            <column name="creation_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="modification_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="deletion_time" type="TIMESTAMP WITH TIME ZONE"/>

            <column name="harvest_permit_application_id" type="BIGINT">
                <constraints nullable="false"
                             references="harvest_permit_application(harvest_permit_application_id)"
                             foreignKeyName="fk_mammal_permit_application_application_id"
                             unique="true"
                             uniqueConstraintName="uk_mammal_permit_application_parent"/>
            </column>
            <column name="area_size" type="INT"/>
            <column name="latitude" type="INT"/>
            <column name="longitude" type="INT"/>
            <column name="accuracy" type="DOUBLE"/>
            <column name="altitude" type="DOUBLE"/>
            <column name="altitude_accuracy" type="DOUBLE"/>
            <column name="geolocation_source" type="VARCHAR(255)"/>
            <column name="area_description" type="TEXT"/>
        </createTable>
    </changeSet>

    <changeSet id="2019-09-19-mammal-application-extended-period-grounds" author="vincit-terole">
        <addColumn tableName="mammal_permit_application">
            <column name="extended_period_grounds" type="VARCHAR(255)"></column>
            <column name="extended_period_grounds_description" type="TEXT"></column>
        </addColumn>
    </changeSet>

    <changeSet id="2019-09-24-add-cause-fields-to-mammal-application" author="vincit-terole">
        <addColumn tableName="mammal_permit_application">
            <column name="deviate_section_32" type="TEXT"/>
            <column name="deviate_section_33" type="TEXT"/>
            <column name="deviate_section_34" type="TEXT"/>
            <column name="deviate_section_35" type="TEXT"/>
            <column name="deviate_section_51" type="TEXT"/>
            <column name="use_traps" type="BOOLEAN" defaultValueBoolean="false"/>
            <column name="use_tape_recorders" type="BOOLEAN" defaultValueBoolean="false"/>
        </addColumn>
    </changeSet>

    <changeSet id="2019-09-30-add-protected-area-name-for-mammal-application" author="vincit-terole">
        <addColumn tableName="mammal_permit_application">
            <column name="protected_area_name" type="TEXT"/>
        </addColumn>
    </changeSet>


    <changeSet id="2019-10-02-mammal-application-reasons" author="vincit-terole">

        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_FLORA_41A"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_FAUNA_41A"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_CROPS_DAMAGE_41A"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_CATTLE_DAMAGE_41A"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_FOREST_DAMAGE_41A"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_FISHING_41A"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_WATER_SYSTEM_41A"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_OTHER_PROPERTY_DAMAGE_41A"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_PUBLIC_HEALTH_41A"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_PUBLIC_SAFETY_41A"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_OTHER_COMMON_INTEREST_41A"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_RESEARCH_41A"/>
        </insert>

        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_FLORA_41C"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_FAUNA_41C"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_CROPS_DAMAGE_41C"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_CATTLE_DAMAGE_41C"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_FOREST_DAMAGE_41C"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_FISHING_41C"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_WATER_SYSTEM_41C"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_OTHER_PROPERTY_DAMAGE_41C"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_PUBLIC_HEALTH_41C"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_PUBLIC_SAFETY_41C"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_OTHER_COMMON_INTEREST_41C"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_RESEARCH_41C"/>
        </insert>

        <createTable tableName="derogation_permit_application_reason">
            <column autoIncrement="true" name="derogation_permit_application_reason_id" type="BIGSERIAL">
                <constraints primaryKey="true" primaryKeyName="derogation_permit_application_reason_pkey"/>
            </column>
            <column name="consistency_version" type="INT" defaultValueNumeric="0">
                <constraints nullable="false"/>
            </column>

            <column name="created_by_user_id" type="BIGINT"/>
            <column name="deleted_by_user_id" type="BIGINT"/>
            <column name="modified_by_user_id" type="BIGINT"/>

            <column name="creation_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="modification_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="deletion_time" type="TIMESTAMP WITH TIME ZONE"/>

            <column name="harvest_permit_application_id" type="BIGINT">
                <constraints nullable="false"
                             references="harvest_permit_application(harvest_permit_application_id)"
                             foreignKeyName="fk_derogation_permit_application_reason_decision_id"/>
            </column>
            <column name="reason_type" type="VARCHAR(255)">
                <constraints nullable="false"
                             references="permit_decision_derogation_reason_type(name)"
                             foreignKeyName="fk_derogation_permit_application_reason_reason_type"/>
            </column>
        </createTable>

        <createIndex tableName="derogation_permit_application_reason"
                     indexName="uk_derogation_permit_application_reason"
                     unique="true">
            <column name="harvest_permit_application_id"/>
            <column name="reason_type"/>
        </createIndex>
    </changeSet>
    <changeSet id="2019-10-30-add-new-mammal-application-reasons" author="vincit-terole">

        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_REINDEER_HUSBANDRY_41A"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_REINDEER_HUSBANDRY_41C"/>
        </insert>
        <insert tableName="permit_decision_derogation_reason_type">
            <column name="name" value="REASON_GAME_HUSBANDRY_41C"/>
        </insert>
    </changeSet>

    <changeSet id="2019-11-04-game_damage_inspection_event" author="vincit-mikkori">
        <createTable tableName="game_damage_inspection_event">
            <column autoIncrement="true" name="game_damage_inspection_event_id" type="BIGSERIAL">
                <constraints primaryKey="true" primaryKeyName="game_damage_inspection_event_pkey"/>
            </column>
            <column name="consistency_version" type="INT" defaultValueNumeric="0">
                <constraints nullable="false"/>
            </column>
            <column name="created_by_user_id" type="BIGINT"/>
            <column name="deleted_by_user_id" type="BIGINT"/>
            <column name="modified_by_user_id" type="BIGINT"/>
            <column name="creation_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="modification_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="deletion_time" type="TIMESTAMP WITH TIME ZONE"/>

            <column name="rhy_id" type="BIGINT">
                <constraints nullable="false"
                             references="organisation(organisation_id)"
                             foreignKeyName="fk_game_damage_inspection_event_rhy"/>
            </column>

            <column name="game_species_id" type="BIGINT">
                <constraints nullable="false"
                             references="game_species(game_species_id)"
                             foreignKeyName="fk_game_damage_species"/>
            </column>
            <column name="inspector_name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>

            <column name="latitude" type="INT"/>
            <column name="longitude" type="INT"/>
            <column name="accuracy" type="DOUBLE"/>
            <column name="altitude" type="DOUBLE"/>
            <column name="altitude_accuracy" type="DOUBLE"/>
            <column name="geolocation_source" type="VARCHAR(255)"/>
            <column name="geom" type="GEOMETRY"/>

            <column name="date" type="TIMESTAMP WITH TIME ZONE">
                <constraints nullable="false"/>
            </column>
            <column name="begin_time" type="TIME WITHOUT TIME ZONE">
                <constraints nullable="false"/>
            </column>
            <column name="end_time" type="TIME WITHOUT TIME ZONE">
                <constraints nullable="false"/>
            </column>
            <column name="description" type="TEXT"/>

            <column name="hourly_expenses_unit" type="NUMERIC(7,2)">
                <constraints nullable="false"/>
            </column>
            <column name="kilometers" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="kilometer_expenses_unit" type="NUMERIC(7,2)">
                <constraints nullable="false"/>
            </column>
            <column name="daily_allowance" type="NUMERIC(7,2)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="2019-11-12-add-damage-inspection-locations-overridden-to-rhy_annual_statistics" author="vincit-mikkori">
        <addColumn tableName="rhy_annual_statistics">
            <column name="mooselike_damage_inspection_locations_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false" />
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="large_carnivore_damage_inspection_locations_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false" />
            </column>
        </addColumn>

        <sql dbms="postgresql"><![CDATA[
            UPDATE rhy_annual_statistics SET mooselike_damage_inspection_locations_overridden = true WHERE mooselike_damage_inspection_locations IS NOT NULL;
            UPDATE rhy_annual_statistics SET large_carnivore_damage_inspection_locations_overridden = true WHERE large_carnivore_damage_inspection_locations IS NOT NULL;
        ]]></sql>
    </changeSet>

    <changeSet id="2019-12-02-change-data-type-of-population-amount" author="vincit-terole">
        <modifyDataType tableName="harvest_permit_application_species_amount"
                        columnName="population_amount"
                        newDataType="TEXT"/>
    </changeSet>

    <changeSet id="2019-11-25-add-substitute_id-to-occupation" author="vincit-mikkori">
        <addColumn tableName="occupation">
            <column name="substitute_id" type="BIGINT">
                <constraints references="person(person_id)"
                             foreignKeyName="fk_occupation_substitute_person_id"/>
            </column>
        </addColumn>
    </changeSet>

    <changeSet id="2019-12-12-drop-uk_board_representation" author="vincit-mikkori">
        <dropUniqueConstraint tableName="occupation" constraintName="uk_board_representation"/>
    </changeSet>

    <changeSet id="2020-01-03-add-srva-other-game-species-statistics-to-rhy_annual_statistics" author="vincit-mikkori">
        <addColumn tableName="rhy_annual_statistics">
            <column name="srva_other_species_accidents" type="INT"/>
            <column name="srva_other_species_deportations" type="INT"/>
            <column name="srva_other_species_injuries" type="INT"/>
        </addColumn>
    </changeSet>

    <changeSet id="2019-11-29-add-hunting_control_cooperation_type" author="vincit-mikkori">
        <createTable tableName="hunting_control_cooperation_type">
            <column name="name" type="VARCHAR(255)">
                <constraints primaryKey="true"/>
            </column>
        </createTable>

        <insert tableName="hunting_control_cooperation_type">
            <column name="name" value="POLIISI"/>
        </insert>
        <insert tableName="hunting_control_cooperation_type">
            <column name="name" value="RAJAVARTIOSTO"/>
        </insert>
        <insert tableName="hunting_control_cooperation_type">
            <column name="name" value="MH"/>
        </insert>
        <insert tableName="hunting_control_cooperation_type">
            <column name="name" value="OMA"/>
        </insert>
    </changeSet>

    <changeSet id="2019-11-29-add-hunting_control_event" author="vincit-mikkori">
        <createTable tableName="hunting_control_event">
            <column autoIncrement="true" name="hunting_control_event_id" type="BIGSERIAL">
                <constraints primaryKey="true" primaryKeyName="hunting_control_event_pkey"/>
            </column>
            <column name="consistency_version" type="INT" defaultValueNumeric="0">
                <constraints nullable="false"/>
            </column>

            <column name="created_by_user_id" type="BIGINT"/>
            <column name="deleted_by_user_id" type="BIGINT"/>
            <column name="modified_by_user_id" type="BIGINT"/>

            <column name="creation_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="modification_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="deletion_time" type="TIMESTAMP WITH TIME ZONE"/>

            <column name="rhy_id" type="BIGINT">
                <constraints nullable="false"
                             references="organisation(organisation_id)"
                             foreignKeyName="fk_hunting_control_event_rhy"/>
            </column>

            <column name="title" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="inspector_count" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="cooperation_type" type="VARCHAR(255)">
                <constraints nullable="false"
                             references="hunting_control_cooperation_type(name)"
                             foreignKeyName="fk_hunting_control_event_cooperation_type"/>
            </column>
            <column name="wolf_territory" type="BOOLEAN">
                <constraints nullable="false"/>
            </column>
            <column name="inspectors" type="TEXT">
                <constraints nullable="false"/>
            </column>

            <column name="latitude" type="INT"/>
            <column name="longitude" type="INT"/>
            <column name="accuracy" type="DOUBLE"/>
            <column name="altitude" type="DOUBLE"/>
            <column name="altitude_accuracy" type="DOUBLE"/>
            <column name="geolocation_source" type="VARCHAR(255)"/>
            <column name="geom" type="GEOMETRY"/>

            <column name="date" type="DATE">
                <constraints nullable="false"/>
            </column>
            <column name="begin_time" type="TIME WITHOUT TIME ZONE">
                <constraints nullable="false"/>
            </column>
            <column name="end_time" type="TIME WITHOUT TIME ZONE">
                <constraints nullable="false"/>
            </column>

            <column name="customers" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="proof_orders" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="description" type="TEXT">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="2019-12-05-add-hunting_control_attachment" author="vincit-mikkori">
        <createTable tableName="hunting_control_attachment">
            <column autoIncrement="true" name="hunting_control_attachment_id" type="BIGSERIAL">
                <constraints primaryKey="true" primaryKeyName="hunting_control_attachment_pkey"/>
            </column>
            <column name="consistency_version" type="INT" defaultValueNumeric="0">
                <constraints nullable="false"/>
            </column>
            <column name="created_by_user_id" type="BIGINT"/>
            <column name="deleted_by_user_id" type="BIGINT"/>
            <column name="modified_by_user_id" type="BIGINT"/>
            <column name="creation_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="modification_time" type="TIMESTAMP WITH TIME ZONE" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="deletion_time" type="TIMESTAMP WITH TIME ZONE"/>

            <column name="hunting_control_event_id" type="BIGINT">
                <constraints nullable="false"
                             references="hunting_control_event(hunting_control_event_id)"
                             foreignKeyName="fk_hunting_control_attachment_event_id"/>
            </column>

            <column name="attachment_metadata_id" type="CHAR(36)">
                <constraints nullable="false"
                             unique="true"
                             references="file_metadata(file_metadata_uuid)"
                             foreignKeyName="fk_hunting_control_attachment_metadata_id"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="2019-12-17-add-hunting-control-statistics-overridden-to-rhy_annual_statistics" author="vincit-mikkori">
        <addColumn tableName="rhy_annual_statistics">
            <column name="hunting_control_events_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false" />
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="hunting_control_customers_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false" />
            </column>
        </addColumn>
        <addColumn tableName="rhy_annual_statistics">
            <column name="proof_orders_overridden" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false" />
            </column>
        </addColumn>

        <sql dbms="postgresql"><![CDATA[
            UPDATE rhy_annual_statistics SET hunting_control_events_overridden = true WHERE hunting_control_events IS NOT NULL;
            UPDATE rhy_annual_statistics SET hunting_control_customers_overridden = true WHERE hunting_control_customers IS NOT NULL;
            UPDATE rhy_annual_statistics SET proof_orders_overridden = true WHERE proof_orders IS NOT NULL;
        ]]></sql>
    </changeSet>

    <changeSet id="2019-12-31-add-rhy-srva-rotation-fields" author="vincit-terole">
        <createTable tableName="srva_rotation">
            <column name="name" type="VARCHAR(255)">
                <constraints primaryKey="true"/>
            </column>
        </createTable>

        <insert tableName="srva_rotation">
            <column name="name" value="DAILY"></column>
        </insert>
        <insert tableName="srva_rotation">
            <column name="name" value="WEEKLY"></column>
        </insert>
        <insert tableName="srva_rotation">
            <column name="name" value="MONTHLY"></column>
        </insert>

        <addColumn tableName="organisation">
            <column type="VARCHAR(255)" name="rhy_srva_rotation">
                <constraints references="srva_rotation(name)"
                             foreignKeyName="fk_organisation_srva_rotation"/>
            </column>
            <column type="date" name="rhy_srva_rotation_start"></column>
        </addColumn>
    </changeSet>
</databaseChangeLog>
